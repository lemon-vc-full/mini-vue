{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observe(value) {\r\n  // 如果value不是对象，什么都不做\r\n  if (typeof value !== \"object\") return;\r\n  // 如果value是对象，创建Observer实例，对数据进行监控\r\n  return new Observer(value);\r\n}\r\n\r\nclass Observer {\r\n  constructor(value) {\r\n    // 判断数据类型，如果是数组，调用数组的方法进行重写\r\n    if (Array.isArray(value)) {\r\n      // 重写数组的方法\r\n      Object.setPrototypeOf(value, arrayMethods);\r\n      // 对数组中的每一项进行监控\r\n      this.observeArray(value);\r\n    } else {\r\n      // 如果是对象，调用walk方法进行监控\r\n      this.walk(value);\r\n    }\r\n  }\r\n  // 遍历对象的所有属性，依次进行监控\r\n  walk(obj) {\r\n    Object.keys(obj).forEach((key) => {\r\n      defineReactive(obj, key, obj[key]);\r\n    });\r\n  }\r\n  // 遍历数组中的每一项，依次进行监控\r\n  observeArray(arr) {\r\n    arr.forEach((item) => observe(item));\r\n  }\r\n}\r\n\r\nfunction defineReactive(obj, key, val) {\r\n  // 如果val是对象，递归调用observe\r\n  observe(val);\r\n  Object.defineProperty(obj, key, {\r\n    get() {\r\n      return val;\r\n    },\r\n    set(newVal) {\r\n      if (newVal === val) return;\r\n      // 如果newVal是对象，递归调用observe\r\n      observe(newVal);\r\n      val = newVal;\r\n    },\r\n  });\r\n}\r\n","import { observe } from \"./observe/index.js\";\r\n\r\nexport function initState(vm) {\r\n  let opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n    if (opts.computed) {\r\n        initComputed(vm);\r\n    }\r\n    if (opts.watch) {\r\n        initWatch(vm);\r\n    }\r\n    if (opts.methods) {\r\n        initMethods(vm);\r\n    }\r\n}\r\n\r\nfunction initProps(vm) {}\r\n\r\nfunction initData(vm) {\r\n  // 获取用户传入的data\r\n  let data = vm.$options.data;\r\n  // 判断data的类型，如果是函数，取函数的返回值作为对象，如果是对象，直接使用\r\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data || {};\r\n  // 监控数据\r\n  observe(data);\r\n}\r\n\r\nfunction initComputed(vm) {}\r\n\r\nfunction initWatch(vm) {}\r\n\r\nfunction initMethods(vm) {}","import { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    let vm = this;\r\n    vm.$options = options; // 将用户传入的options参数挂载到vm上\r\n    // 初始化状态\r\n    initState(vm);\r\n  };\r\n}\r\n","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["observe","value","_typeof","Observer","_classCallCheck","Array","isArray","Object","setPrototypeOf","arrayMethods","observeArray","walk","_createClass","key","obj","keys","forEach","defineReactive","arr","item","val","defineProperty","get","set","newVal","initState","vm","opts","$options","props","data","initData","computed","watch","methods","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,OAAOA,CAACC,KAAK,EAAE;EAC7B;EACA,EAAA,IAAIC,OAAA,CAAOD,KAAK,CAAA,KAAK,QAAQ,EAAE,OAAA;EAC/B;EACA,EAAA,OAAO,IAAIE,QAAQ,CAACF,KAAK,CAAC,CAAA;EAC5B,CAAA;EAAC,IAEKE,QAAQ,gBAAA,YAAA;IACZ,SAAAA,QAAAA,CAAYF,KAAK,EAAE;EAAAG,IAAAA,eAAA,OAAAD,QAAA,CAAA,CAAA;EACjB;EACA,IAAA,IAAIE,KAAK,CAACC,OAAO,CAACL,KAAK,CAAC,EAAE;EACxB;EACAM,MAAAA,MAAM,CAACC,cAAc,CAACP,KAAK,EAAEQ,YAAY,CAAC,CAAA;EAC1C;EACA,MAAA,IAAI,CAACC,YAAY,CAACT,KAAK,CAAC,CAAA;EAC1B,KAAC,MAAM;EACL;EACA,MAAA,IAAI,CAACU,IAAI,CAACV,KAAK,CAAC,CAAA;EAClB,KAAA;EACF,GAAA;EACA;EAAAW,EAAAA,YAAA,CAAAT,QAAA,EAAA,CAAA;MAAAU,GAAA,EAAA,MAAA;EAAAZ,IAAAA,KAAA,EACA,SAAAU,IAAKG,CAAAA,GAAG,EAAE;QACRP,MAAM,CAACQ,IAAI,CAACD,GAAG,CAAC,CAACE,OAAO,CAAC,UAACH,GAAG,EAAK;UAChCI,cAAc,CAACH,GAAG,EAAED,GAAG,EAAEC,GAAG,CAACD,GAAG,CAAC,CAAC,CAAA;EACpC,OAAC,CAAC,CAAA;EACJ,KAAA;EACA;EAAA,GAAA,EAAA;MAAAA,GAAA,EAAA,cAAA;EAAAZ,IAAAA,KAAA,EACA,SAAAS,YAAaQ,CAAAA,GAAG,EAAE;EAChBA,MAAAA,GAAG,CAACF,OAAO,CAAC,UAACG,IAAI,EAAA;UAAA,OAAKnB,OAAO,CAACmB,IAAI,CAAC,CAAA;SAAC,CAAA,CAAA;EACtC,KAAA;EAAC,GAAA,CAAA,CAAA,CAAA;EAAA,EAAA,OAAAhB,QAAA,CAAA;EAAA,CAAA,EAAA,CAAA;EAGH,SAASc,cAAcA,CAACH,GAAG,EAAED,GAAG,EAAEO,GAAG,EAAE;EACrC;IACApB,OAAO,CAACoB,GAAG,CAAC,CAAA;EACZb,EAAAA,MAAM,CAACc,cAAc,CAACP,GAAG,EAAED,GAAG,EAAE;MAC9BS,GAAG,EAAA,SAAAA,MAAG;EACJ,MAAA,OAAOF,GAAG,CAAA;OACX;MACDG,GAAG,EAAA,SAAAA,GAACC,CAAAA,MAAM,EAAE;QACV,IAAIA,MAAM,KAAKJ,GAAG,EAAE,OAAA;EACpB;QACApB,OAAO,CAACwB,MAAM,CAAC,CAAA;EACfJ,MAAAA,GAAG,GAAGI,MAAM,CAAA;EACd,KAAA;EACF,GAAC,CAAC,CAAA;EACJ;;EC5CO,SAASC,SAASA,CAACC,EAAE,EAAE;EAC5B,EAAA,IAAIC,IAAI,GAAGD,EAAE,CAACE,QAAQ,CAAA;IACtB,IAAID,IAAI,CAACE,KAAK,EAAE,CAEhB;IACA,IAAIF,IAAI,CAACG,IAAI,EAAE;MACbC,QAAQ,CAACL,EAAE,CAAC,CAAA;EACd,GAAA;IACE,IAAIC,IAAI,CAACK,QAAQ,EAAE,CAEnB;IACA,IAAIL,IAAI,CAACM,KAAK,EAAE,CAEhB;IACA,IAAIN,IAAI,CAACO,OAAO,EAAE,CAElB;EACJ,CAAA;EAIA,SAASH,QAAQA,CAACL,EAAE,EAAE;EACpB;EACA,EAAA,IAAII,IAAI,GAAGJ,EAAE,CAACE,QAAQ,CAACE,IAAI,CAAA;EAC3B;IACAA,IAAI,GAAGJ,EAAE,CAACS,KAAK,GAAG,OAAOL,IAAI,KAAK,UAAU,GAAGA,IAAI,CAACM,IAAI,CAACV,EAAE,CAAC,GAAGI,IAAI,IAAI,EAAE,CAAA;EACzE;IACA9B,OAAO,CAAC8B,IAAI,CAAC,CAAA;EACf;;EC5BO,SAASO,SAASA,CAACC,GAAG,EAAE;EAC7BA,EAAAA,GAAG,CAACC,SAAS,CAACC,KAAK,GAAG,UAAUC,OAAO,EAAE;MACvC,IAAIf,EAAE,GAAG,IAAI,CAAA;EACbA,IAAAA,EAAE,CAACE,QAAQ,GAAGa,OAAO,CAAC;EACtB;MACAhB,SAAS,CAACC,EAAE,CAAC,CAAA;KACd,CAAA;EACH;;ECPA,SAASY,GAAGA,CAACG,OAAO,EAAE;EACpB,EAAA,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAA;EACrB,CAAA;EAEAJ,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}